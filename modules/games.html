
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Security games &#8212; ToyCrypto 0.5.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=1dd76d02"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'modules/games';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Vigenère cipher" href="vigenere.html" />
    <link rel="prev" title="Elliptic curves" href="ec.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="0.5.0" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">ToyCrypto (0.5.0)</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../intro/quickstart.html">
    Installing & Importing
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../why/index.html">
    Motiviation
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    The modules
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../bibliography.html">
    Bibliography
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/toycrypto/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../_static/pypi-logo-no-text.svg" class="icon-link-image" alt="PyPI"/></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/jpgoldberg/toy-crypto-math" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../intro/quickstart.html">
    Installing & Importing
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../why/index.html">
    Motiviation
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    The modules
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../bibliography.html">
    Bibliography
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/toycrypto/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../_static/pypi-logo-no-text.svg" class="icon-link-image" alt="PyPI"/></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/jpgoldberg/toy-crypto-math" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Main modules</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="nt.html">Number Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="sieve.html">Sieve of Eratosthenes</a></li>
<li class="toctree-l1"><a class="reference internal" href="birthday.html">Birthday Paradox Computations</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="rsa/index.html">RSA</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="rsa/primitive.html">Primitive RSA</a></li>
<li class="toctree-l2"><a class="reference internal" href="rsa/keygen.html">RSA Key Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="rsa/oaep.html">OAEP</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="ec.html">Elliptic curves</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Security games</a></li>
<li class="toctree-l1"><a class="reference internal" href="vigenere.html">Vigenère cipher</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Utility modules</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="wycheproof/index.html">Wycheproof</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="wycheproof/index.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="wycheproof/usage.html">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="wycheproof/api.html">API</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="rand.html">Random Numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Utility functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="bit_utils.html">Bit manipulation utiltieis</a></li>
<li class="toctree-l1"><a class="reference internal" href="types.html">Types</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item"><nav class="sidebar-indices-items" aria-labelledby="pst-indices-navigation-heading-2">
  <p id="pst-indices-navigation-heading-2" class="sidebar-indices-items__title" role="heading" aria-level="1">Indices</p>
  <ul class="indices-link">
        <li class="toctree-l1">
          <a class="reference internal"
             href="../genindex.html"
             accesskey="I">General Index</a>
        </li>
        <li class="toctree-l1">
          <a class="reference internal" href="../py-modindex.html">Python Module Index</a>
        </li>
  </ul>
</nav></div>
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">The modules</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Security games</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>Nothing here should be used for any security purposes.</p>
<ul class="simple">
<li><p>If you need cryptographic tools in a Python environment use <a class="reference external" href="https://cryptography.io/en/latest/">pyca</a> or <a class="reference external" href="https://pynacl.readthedocs.io/en/latest/">PyNaCl</a>.</p></li>
<li><p>If you need efficient and reliable abstract math utilities in a Python-like environment consider using <a class="reference external" href="https://www.sagemath.org">SageMath</a>.</p></li>
</ul>
</div>
<section id="module-toy_crypto.sec_games">
<span id="security-games"></span><h1>Security games<a class="headerlink" href="#module-toy_crypto.sec_games" title="Link to this heading">#</a></h1>
<p>Imported with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">toy_crypto.sec_games</span>
</pre></div>
</div>
<p>The module includes a classes for running the several
<a class="reference external" href="https://en.wikipedia.org/wiki/Ciphertext_indistinguishability">ciphertext indistisguishability</a>
games for symmetric encryption.</p>
<section id="general-structure">
<h2>General Structure<a class="headerlink" href="#general-structure" title="Link to this heading">#</a></h2>
<p>Indisitinguisibility games are set up as an adversary
playing against a game (or Challenger).
The game is given an encryption scheme and a key generation function.
So creating a game will often look like</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">keygen</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
    <span class="o">...</span>

<span class="k">def</span><span class="w"> </span><span class="nf">encrypt</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="n">by</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
    <span class="o">...</span>

<span class="n">game</span> <span class="o">=</span> <span class="n">IndCpa</span><span class="p">(</span><span class="n">keygen</span><span class="p">,</span> <span class="n">encrypt</span><span class="p">)</span>
</pre></div>
</div>
<p>Once that is done, the adversary can interact with the game according to the rules of the particular game.</p>
<p>The first thing (in how I’ve coded things here) is that the adversary will tell the game to initialize itself.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">game</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
<span class="o">...</span>
</pre></div>
</div>
<p>During that initialization the game will
generate a key and randomly select 0 or 1 as the value of the bit <strong>b</strong>.
The adversary’s task during the course of the game is to figure out the value of <strong>b</strong>.</p>
<p>At the end of a round, the adversary will finalize the game by submitting its guess.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="k">if</span> <span class="n">game</span><span class="o">.</span><span class="n">finalize</span><span class="p">(</span><span class="n">guess</span><span class="p">):</span>
    <span class="c1"># Yay! Guessed correctly</span>
    <span class="n">adv_score</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>The only thing the adversary can do with the game after finalizing is
to tell it to re-initialize <a class="footnote-reference brackets" href="#reinit" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> , which will generate a fresh key and value for the bit, <strong>b</strong>.</p>
<p>Between initialization and finalization the adversary can ask the game to
to perform certain computions, which may include encrypting or decrypting
data of the adversary’s chosing.
Which methods are available and in what sequences they can be called
depends on the specific game.</p>
<p>The computation that is essential to all of these games is to encrypt one of
two messages provided by the adversary.
The game returns a challenge ciphertext that is the encryption of one of
the messages depending on its value of <strong>b</strong>.
So the adversary is really trying to figure out if whether it is the left or right message that gets encrypted.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">game</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
<span class="o">...</span>
<span class="n">challenge_ctext</span> <span class="o">=</span> <span class="n">game</span><span class="o">.</span><span class="n">encrypt_one</span><span class="p">(</span><span class="n">m0</span><span class="p">,</span> <span class="n">m1</span><span class="p">)</span>
<span class="o">...</span>
<span class="k">if</span> <span class="n">game</span><span class="o">.</span><span class="n">finalize</span><span class="p">(</span><span class="n">guess</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>To save having to create many instances of a game with the same encryption
scheme, py:func:<cite>Ind.initialize</cite> can be called after a game is
finalized to start over with a fresh key and <strong>b</strong>
while using the same encryption scheme. <a class="footnote-reference brackets" href="#reinit" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a></p>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Link to this heading">#</a></h2>
<p>For testing it is useful to have a challenge that the adversary can always
win, so we will use a shift ciper for testing IND-EAV
and a reused pad (N-time-pad) for testing IND-CPA.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">secrets</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">toy_crypto.sec_games</span><span class="w"> </span><span class="kn">import</span> <span class="n">IndEav</span><span class="p">,</span> <span class="n">IndCpa</span>

<span class="k">def</span><span class="w"> </span><span class="nf">shift_encrypt</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
    <span class="n">encrypted</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">([(</span><span class="n">b</span> <span class="o">+</span> <span class="n">key</span><span class="p">)</span> <span class="o">%</span> <span class="mi">256</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">m</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">encrypted</span>

<span class="k">def</span><span class="w"> </span><span class="nf">shift_keygen</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">secrets</span><span class="o">.</span><span class="n">randbelow</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span>
</pre></div>
</div>
<p>The shift-cipher IND-EAV condition
(and thus does not provide semantic security).
The adversary will set <code class="code docutils literal notranslate"><span class="pre">m0</span> <span class="pre">=</span> <span class="pre">&quot;AA&quot;</span></code> and <code class="code docutils literal notranslate"><span class="pre">m1</span> <span class="pre">=</span> <span class="pre">AB</span></code>.
If m0 is encrypted then the two bytes of the challenge ciphertext will
be the same as each other. If they differ, then m1 was encrypted.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">game</span> <span class="o">=</span> <span class="n">IndEav</span><span class="p">(</span><span class="n">shift_keygen</span><span class="p">,</span> <span class="n">shift_encrypt</span><span class="p">)</span>
<span class="n">game</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>

<span class="n">m0</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;AA&quot;</span>
<span class="n">m1</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;AB&quot;</span>
<span class="n">ctext</span> <span class="o">=</span> <span class="n">game</span><span class="o">.</span><span class="n">encrypt_one</span><span class="p">(</span><span class="n">m0</span><span class="p">,</span> <span class="n">m1</span><span class="p">)</span>

<span class="n">guess</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">ctext</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">ctext</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="k">assert</span> <span class="n">game</span><span class="o">.</span><span class="n">finalize</span><span class="p">(</span><span class="n">guess</span><span class="p">)</span>  <span class="c1"># passes if guess is correct</span>
</pre></div>
</div>
<p>Let’s use a stronger cipher, the N-Time-Pad for our IND-CPA example.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># import secrets  # already imported</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">toy_crypto.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">xor</span>

<span class="k">def</span><span class="w"> </span><span class="nf">ntp_keygen</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">secrets</span><span class="o">.</span><span class="n">token_bytes</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">ntp_encrypt</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;message too long&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">xor</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
<p>The N-Time-Pad (up to limited message length) is semantically secure.
One can prove that any adversary that can reliability win the IND-EAV game
can reliabily predict bits from the (presumedly secure) random number generator.
Thus the NTP is at least as secure as the random number generator.</p>
<p>But because the NTP is deterministic it will fail IND-CPA security.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">game</span> <span class="o">=</span> <span class="n">IndCpa</span><span class="p">(</span><span class="n">ntp_keygen</span><span class="p">,</span> <span class="n">ntp_encrypt</span><span class="p">)</span>
<span class="n">game</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>

<span class="n">m0</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Attack at dawn!&quot;</span>
<span class="n">m1</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Attack at dusk!&quot;</span>
<span class="n">ctext1</span> <span class="o">=</span> <span class="n">game</span><span class="o">.</span><span class="n">encrypt_one</span><span class="p">(</span><span class="n">m0</span><span class="p">,</span> <span class="n">m1</span><span class="p">)</span>
<span class="n">ctext2</span> <span class="o">=</span> <span class="n">game</span><span class="o">.</span><span class="n">encrypt_one</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m1</span><span class="p">)</span>

<span class="n">guess</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">ctext1</span> <span class="o">==</span> <span class="n">ctext2</span>

<span class="k">assert</span> <span class="n">game</span><span class="o">.</span><span class="n">finalize</span><span class="p">(</span><span class="n">guess</span><span class="p">)</span>  <span class="c1"># passes if guess is correct</span>
</pre></div>
</div>
</section>
<section id="exceptions">
<h2>Exceptions<a class="headerlink" href="#exceptions" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="toy_crypto.sec_games.StateError">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">toy_crypto.sec_games.</span></span><span class="sig-name descname"><span class="pre">StateError</span></span><a class="reference internal" href="../_modules/toy_crypto/sec_games.html#StateError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#toy_crypto.sec_games.StateError" title="Link to this definition">#</a></dt>
<dd><p>When something attempted in an inappropriate state.</p>
</dd></dl>

</section>
<section id="types-for-encryption-scheme">
<h2>Types for encryption scheme<a class="headerlink" href="#types-for-encryption-scheme" title="Link to this heading">#</a></h2>
<p>When a game is set up, it must be given an encryption scheme,
which will include a key generation function, an encryption function,
and optionally a decryption function.</p>
<p>Sphinx doesn’t seem to have good ways of documenting these,
but hopefully what I list here makes some sense.</p>
<dl class="py data">
<dt class="sig sig-object py" id="toy_crypto.sec_games.K">
<span class="sig-prename descclassname"><span class="pre">toy_crypto.sec_games.</span></span><span class="sig-name descname"><span class="pre">K</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">TypeVar(K)</span></em><a class="headerlink" href="#toy_crypto.sec_games.K" title="Link to this definition">#</a></dt>
<dd><p><strong>Type:</strong>    <code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code></p>
<p>Invariant <code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>.</p>
<p>Unbounded type variable intended for any type of key.</p>
</dd></dl>

<dl class="py type">
<dt class="sig sig-object py" id="toy_crypto.sec_games.KeyGenerator">
<em class="property"><span class="k"><span class="pre">type</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">toy_crypto.sec_games.</span></span><span class="sig-name descname"><span class="pre">KeyGenerator</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">K</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#toy_crypto.sec_games.KeyGenerator" title="Link to this definition">#</a></dt>
<dd><p>A parameterized type alias for the key generation function.</p>
</dd></dl>

<dl class="py type">
<dt class="sig sig-object py" id="toy_crypto.sec_games.Cryptor">
<em class="property"><span class="k"><span class="pre">type</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">toy_crypto.sec_games.</span></span><span class="sig-name descname"><span class="pre">Cryptor</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#toy_crypto.sec_games.Cryptor" title="Link to this definition">#</a></dt>
<dd><p>A parameterized type alias to describe the encryptor/decrptor functions.</p>
</dd></dl>

</section>
<section id="the-class-and-method-organization">
<h2>The class and method organization<a class="headerlink" href="#the-class-and-method-organization" title="Link to this heading">#</a></h2>
<p>All of the specific game classes are subclasses of the <a class="reference internal" href="#toy_crypto.sec_games.Ind" title="toy_crypto.sec_games.Ind"><code class="xref py py-class docutils literal notranslate"><span class="pre">Ind</span></code></a> class.</p>
<dl class="py class">
<dt class="sig sig-object py" id="toy_crypto.sec_games.Ind">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">toy_crypto.sec_games.</span></span><span class="sig-name descname"><span class="pre">Ind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key_gen</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">KeyGenerator</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encryptor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Cryptor</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decryptor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Cryptor</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#toy_crypto.sec_games.TransitionTable" title="toy_crypto.sec_games.TransitionTable"><span class="pre">TransitionTable</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/toy_crypto/sec_games.html#Ind"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#toy_crypto.sec_games.Ind" title="Link to this definition">#</a></dt>
<dd><p>A super class for symmetric Indistinguishability games.</p>
<p>Unless the user provides an appropriate transition table,
no methods will be allowed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key_gen</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenericAlias</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">K</span></code>)]</span>)</p></li>
<li><p><strong>encryptor</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenericAlias</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">K</span></code>)]</span>)</p></li>
<li><p><strong>decryptor</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">GenericAlias</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">K</span></code>)]]</span>, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><strong>transition_table</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="#toy_crypto.sec_games.TransitionTable" title="toy_crypto.sec_games.TransitionTable"><code class="xref py py-class docutils literal notranslate"><span class="pre">TransitionTable</span></code></a>]</span>, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="toy_crypto.sec_games.Ind.TRACK_CHALLENGE_CTEXTS">
<span class="sig-name descname"><span class="pre">TRACK_CHALLENGE_CTEXTS</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><a class="headerlink" href="#toy_crypto.sec_games.Ind.TRACK_CHALLENGE_CTEXTS" title="Link to this definition">#</a></dt>
<dd><p>Game does not track which challenge texts have been created</p>
</dd></dl>

</dd></dl>

<p>The classes optionally differ in which methods they offer and the sequence in which they are called.
That ordiering defined by the transition tables in <code class="xref py py-data docutils literal notranslate"><span class="pre">T_TABLE</span></code>
with the initial stated being <a class="reference internal" href="#toy_crypto.sec_games.State.STARTED" title="toy_crypto.sec_games.State.STARTED"><code class="xref py py-data docutils literal notranslate"><span class="pre">State.STARTED</span></code></a>.</p>
<p>All games allow the <a class="reference internal" href="#toy_crypto.sec_games.Ind.initialize" title="toy_crypto.sec_games.Ind.initialize"><code class="xref py py-func docutils literal notranslate"><span class="pre">initialize()</span></code></a>,
<a class="reference internal" href="#toy_crypto.sec_games.Ind.encrypt_one" title="toy_crypto.sec_games.Ind.encrypt_one"><code class="xref py py-func docutils literal notranslate"><span class="pre">encrypt_one()</span></code></a>
and <a class="reference internal" href="#toy_crypto.sec_games.Ind.finalize" title="toy_crypto.sec_games.Ind.finalize"><code class="xref py py-func docutils literal notranslate"><span class="pre">finalize()</span></code></a>, methods.</p>
<dl class="py method">
<dt class="sig sig-object py" id="toy_crypto.sec_games.Ind.initialize">
<span class="sig-prename descclassname"><span class="pre">Ind.</span></span><span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/toy_crypto/sec_games.html#Ind.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#toy_crypto.sec_games.Ind.initialize" title="Link to this definition">#</a></dt>
<dd><p>Initializes self by creating key and selecting b.</p>
<p>Also clears an saved challenge ciphertexts.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#toy_crypto.sec_games.StateError" title="toy_crypto.sec_games.StateError"><strong>StateError</strong></a> – if method called when disallowed.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="toy_crypto.sec_games.Ind.encrypt_one">
<span class="sig-prename descclassname"><span class="pre">Ind.</span></span><span class="sig-name descname"><span class="pre">encrypt_one</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bytes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bytes</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bytes</span></span></span><a class="reference internal" href="../_modules/toy_crypto/sec_games.html#Ind.encrypt_one"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#toy_crypto.sec_games.Ind.encrypt_one" title="Link to this definition">#</a></dt>
<dd><p>Left-Right encryption oracle.</p>
<p>Challenger encrypts m0 if b is False, else encrypts m1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m0</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></span>) – Left message</p></li>
<li><p><strong>m1</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></span>) – Right message</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – if lengths of m0 and m1 are not equal.</p></li>
<li><p><a class="reference internal" href="#toy_crypto.sec_games.StateError" title="toy_crypto.sec_games.StateError"><strong>StateError</strong></a> – if method called when disallowed.</p></li>
</ul>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="toy_crypto.sec_games.Ind.finalize">
<span class="sig-prename descclassname"><span class="pre">Ind.</span></span><span class="sig-name descname"><span class="pre">finalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">guess</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="types.html#toy_crypto.types.SupportsBool" title="toy_crypto.types.SupportsBool"><span class="pre">SupportsBool</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/toy_crypto/sec_games.html#Ind.finalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#toy_crypto.sec_games.Ind.finalize" title="Link to this definition">#</a></dt>
<dd><p>True iff guess is the same as b of previously created challenger.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#toy_crypto.sec_games.StateError" title="toy_crypto.sec_games.StateError"><strong>StateError</strong></a> – if method called when disallowed.</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>guess</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="types.html#toy_crypto.types.SupportsBool" title="toy_crypto.types.SupportsBool"><code class="xref py py-class docutils literal notranslate"><span class="pre">SupportsBool</span></code></a></span>)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span></p>
</dd>
</dl>
</dd></dl>

<p>Some of the games allow the <a class="reference internal" href="#toy_crypto.sec_games.Ind.encrypt" title="toy_crypto.sec_games.Ind.encrypt"><code class="xref py py-func docutils literal notranslate"><span class="pre">encrypt()</span></code></a>
and <a class="reference internal" href="#toy_crypto.sec_games.Ind.decrypt" title="toy_crypto.sec_games.Ind.decrypt"><code class="xref py py-func docutils literal notranslate"><span class="pre">decrypt()</span></code></a>, methods.</p>
<dl class="py method">
<dt class="sig sig-object py" id="toy_crypto.sec_games.Ind.encrypt">
<span class="sig-prename descclassname"><span class="pre">Ind.</span></span><span class="sig-name descname"><span class="pre">encrypt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ptext</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bytes</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bytes</span></span></span><a class="reference internal" href="../_modules/toy_crypto/sec_games.html#Ind.encrypt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#toy_crypto.sec_games.Ind.encrypt" title="Link to this definition">#</a></dt>
<dd><p>Encryption oracle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ptext</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></span>) – Message to be encrypted</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#toy_crypto.sec_games.StateError" title="toy_crypto.sec_games.StateError"><strong>StateError</strong></a> – if method called when disallowed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="toy_crypto.sec_games.Ind.decrypt">
<span class="sig-prename descclassname"><span class="pre">Ind.</span></span><span class="sig-name descname"><span class="pre">decrypt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctext</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bytes</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bytes</span></span></span><a class="reference internal" href="../_modules/toy_crypto/sec_games.html#Ind.decrypt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#toy_crypto.sec_games.Ind.decrypt" title="Link to this definition">#</a></dt>
<dd><p>Decryption oracle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ctext</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></span>) – Ciphertext to be decrypted</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#toy_crypto.sec_games.StateError" title="toy_crypto.sec_games.StateError"><strong>StateError</strong></a> – if method called when disallowed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></span></p>
</dd>
</dl>
</dd></dl>

<p>The only difference between <a class="reference internal" href="#toy_crypto.sec_games.IndEav" title="toy_crypto.sec_games.IndEav"><code class="xref py py-class docutils literal notranslate"><span class="pre">IndEav</span></code></a> and <a class="reference internal" href="#toy_crypto.sec_games.IndCpa" title="toy_crypto.sec_games.IndCpa"><code class="xref py py-class docutils literal notranslate"><span class="pre">IndCpa</span></code></a> is that the latter allows multiple calls to <code class="xref py py-func docutils literal notranslate"><span class="pre">encrypt_one()</span></code>.</p>
<dl class="py class">
<dt class="sig sig-object py" id="toy_crypto.sec_games.IndEav">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">toy_crypto.sec_games.</span></span><span class="sig-name descname"><span class="pre">IndEav</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key_gen</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">KeyGenerator</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encryptor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Cryptor</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/toy_crypto/sec_games.html#IndEav"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#toy_crypto.sec_games.IndEav" title="Link to this definition">#</a></dt>
<dd><p>IND-EAV game.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key_gen</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenericAlias</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">K</span></code>)]</span>) – A key generation function appropriate for encryptor</p></li>
<li><p><strong>encryptor</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenericAlias</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">K</span></code>)]</span>) – A function that takes a key and message and outputs ctext</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#toy_crypto.sec_games.StateError" title="toy_crypto.sec_games.StateError"><strong>StateError</strong></a> – if methods called in disallowed order.</p>
</dd>
</dl>
<dl class="py data">
<dt class="sig sig-object py" id="toy_crypto.sec_games.IndEav.IndEav.T_TABLE">
<span class="sig-name descname"><span class="pre">T_TABLE</span></span><a class="headerlink" href="#toy_crypto.sec_games.IndEav.IndEav.T_TABLE" title="Link to this definition">#</a></dt>
<dd><p>Transition Table to manage state of a game.</p>
<p>It can be treated like a mapping.</p>
</dd></dl>

<dd><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">TransitionTable</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="p">{</span> <span class="o">&lt;</span><span class="n">State</span><span class="o">.</span><span class="n">STARTED</span><span class="p">:</span> <span class="s1">&#39;S&#39;</span><span class="o">&gt;</span><span class="p">:</span> <span class="p">{</span> <span class="o">&lt;</span><span class="n">Action</span><span class="o">.</span><span class="n">INITIALIZE</span><span class="p">:</span> <span class="s1">&#39;initialize&#39;</span><span class="o">&gt;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">State</span><span class="o">.</span><span class="n">INITIALIZED</span><span class="p">:</span> <span class="s1">&#39;I&#39;</span><span class="o">&gt;</span><span class="p">},</span>
                        <span class="o">&lt;</span><span class="n">State</span><span class="o">.</span><span class="n">INITIALIZED</span><span class="p">:</span> <span class="s1">&#39;I&#39;</span><span class="o">&gt;</span><span class="p">:</span> <span class="p">{</span> <span class="o">&lt;</span><span class="n">Action</span><span class="o">.</span><span class="n">ENCRYPT_ONE</span><span class="p">:</span> <span class="s1">&#39;encrypt_one&#39;</span><span class="o">&gt;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">State</span><span class="o">.</span><span class="n">CHALLENGED</span><span class="p">:</span> <span class="s1">&#39;C&#39;</span><span class="o">&gt;</span><span class="p">},</span>
                        <span class="o">&lt;</span><span class="n">State</span><span class="o">.</span><span class="n">CHALLENGED</span><span class="p">:</span> <span class="s1">&#39;C&#39;</span><span class="o">&gt;</span><span class="p">:</span> <span class="p">{</span> <span class="o">&lt;</span><span class="n">Action</span><span class="o">.</span><span class="n">FINALIZE</span><span class="p">:</span> <span class="s1">&#39;finalize&#39;</span><span class="o">&gt;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">State</span><span class="o">.</span><span class="n">STARTED</span><span class="p">:</span> <span class="s1">&#39;S&#39;</span><span class="o">&gt;</span><span class="p">}})</span>
</pre></div>
</div>
</dd><figure class="align-center" id="id3">
<img alt="State transition diagram generated from T_TABLE" src="../_images/IND-EAV.png" />
<figcaption>
<p><span class="caption-text">IND-EAV game states and transitions</span><a class="headerlink" href="#id3" title="Link to this image">#</a></p>
</figcaption>
</figure>
<dl class="py attribute">
<dt class="sig sig-object py" id="toy_crypto.sec_games.IndEav.TRACK_CHALLENGE_CTEXTS">
<span class="sig-name descname"><span class="pre">TRACK_CHALLENGE_CTEXTS</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#toy_crypto.sec_games.IndEav.TRACK_CHALLENGE_CTEXTS" title="Link to this definition">#</a></dt>
<dd><p>This game does not need to record challenge ctexts.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="toy_crypto.sec_games.IndCpa">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">toy_crypto.sec_games.</span></span><span class="sig-name descname"><span class="pre">IndCpa</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key_gen</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">KeyGenerator</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encryptor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Cryptor</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/toy_crypto/sec_games.html#IndCpa"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#toy_crypto.sec_games.IndCpa" title="Link to this definition">#</a></dt>
<dd><p>IND-CPA game.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key_gen</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenericAlias</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">K</span></code>)]</span>) – A key generation function appropriate for encryptor</p></li>
<li><p><strong>encryptor</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenericAlias</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">K</span></code>)]</span>) – A function that takes a key and message and outputs ctext</p></li>
</ul>
</dd>
</dl>
<dl class="py data">
<dt class="sig sig-object py" id="toy_crypto.sec_games.IndCpa.IndCpa.T_TABLE">
<span class="sig-name descname"><span class="pre">T_TABLE</span></span><a class="headerlink" href="#toy_crypto.sec_games.IndCpa.IndCpa.T_TABLE" title="Link to this definition">#</a></dt>
<dd><p>Transition Table to manage state of a game.</p>
<p>It can be treated like a mapping.</p>
</dd></dl>

<dd><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">TransitionTable</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="p">{</span> <span class="o">&lt;</span><span class="n">State</span><span class="o">.</span><span class="n">STARTED</span><span class="p">:</span> <span class="s1">&#39;S&#39;</span><span class="o">&gt;</span><span class="p">:</span> <span class="p">{</span> <span class="o">&lt;</span><span class="n">Action</span><span class="o">.</span><span class="n">INITIALIZE</span><span class="p">:</span> <span class="s1">&#39;initialize&#39;</span><span class="o">&gt;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">State</span><span class="o">.</span><span class="n">INITIALIZED</span><span class="p">:</span> <span class="s1">&#39;I&#39;</span><span class="o">&gt;</span><span class="p">},</span>
                        <span class="o">&lt;</span><span class="n">State</span><span class="o">.</span><span class="n">INITIALIZED</span><span class="p">:</span> <span class="s1">&#39;I&#39;</span><span class="o">&gt;</span><span class="p">:</span> <span class="p">{</span> <span class="o">&lt;</span><span class="n">Action</span><span class="o">.</span><span class="n">ENCRYPT_ONE</span><span class="p">:</span> <span class="s1">&#39;encrypt_one&#39;</span><span class="o">&gt;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">State</span><span class="o">.</span><span class="n">CHALLENGED</span><span class="p">:</span> <span class="s1">&#39;C&#39;</span><span class="o">&gt;</span><span class="p">},</span>
                        <span class="o">&lt;</span><span class="n">State</span><span class="o">.</span><span class="n">CHALLENGED</span><span class="p">:</span> <span class="s1">&#39;C&#39;</span><span class="o">&gt;</span><span class="p">:</span> <span class="p">{</span> <span class="o">&lt;</span><span class="n">Action</span><span class="o">.</span><span class="n">ENCRYPT_ONE</span><span class="p">:</span> <span class="s1">&#39;encrypt_one&#39;</span><span class="o">&gt;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">State</span><span class="o">.</span><span class="n">CHALLENGED</span><span class="p">:</span> <span class="s1">&#39;C&#39;</span><span class="o">&gt;</span><span class="p">,</span>
                                                   <span class="o">&lt;</span><span class="n">Action</span><span class="o">.</span><span class="n">FINALIZE</span><span class="p">:</span> <span class="s1">&#39;finalize&#39;</span><span class="o">&gt;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">State</span><span class="o">.</span><span class="n">STARTED</span><span class="p">:</span> <span class="s1">&#39;S&#39;</span><span class="o">&gt;</span><span class="p">}})</span>
</pre></div>
</div>
</dd><figure class="align-center" id="id4">
<img alt="State transition diagram generated from T_TABLE" src="../_images/IND-CPA.png" />
<figcaption>
<p><span class="caption-text">IND-CPA game states and transitions</span><a class="headerlink" href="#id4" title="Link to this image">#</a></p>
</figcaption>
</figure>
<dl class="py attribute">
<dt class="sig sig-object py" id="toy_crypto.sec_games.IndCpa.TRACK_CHALLENGE_CTEXTS">
<span class="sig-name descname"><span class="pre">TRACK_CHALLENGE_CTEXTS</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#toy_crypto.sec_games.IndCpa.TRACK_CHALLENGE_CTEXTS" title="Link to this definition">#</a></dt>
<dd><p>This game does not need to record challenge ctexts.</p>
</dd></dl>

</dd></dl>

<p>The only difference between <a class="reference internal" href="#toy_crypto.sec_games.IndCca1" title="toy_crypto.sec_games.IndCca1"><code class="xref py py-class docutils literal notranslate"><span class="pre">IndCca1</span></code></a> and <a class="reference internal" href="#toy_crypto.sec_games.IndCca2" title="toy_crypto.sec_games.IndCca2"><code class="xref py py-class docutils literal notranslate"><span class="pre">IndCca2</span></code></a> is
the latter allows calls to <code class="xref py py-func docutils literal notranslate"><span class="pre">decrypt()</span></code> the challenge ciphertext
has been provided by <code class="xref py py-func docutils literal notranslate"><span class="pre">encrypt_one()</span></code>.
The challenge ciphertext cannot be given to <code class="xref py py-func docutils literal notranslate"><span class="pre">decrypt()</span></code>.</p>
<dl class="py class">
<dt class="sig sig-object py" id="toy_crypto.sec_games.IndCca1">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">toy_crypto.sec_games.</span></span><span class="sig-name descname"><span class="pre">IndCca1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key_gen</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">KeyGenerator</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encryptor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Cryptor</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decrytpor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Cryptor</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/toy_crypto/sec_games.html#IndCca1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#toy_crypto.sec_games.IndCca1" title="Link to this definition">#</a></dt>
<dd><p>IND-CCA1 game.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key_gen</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenericAlias</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">K</span></code>)]</span>) – A key generation function appropriate for encryptor</p></li>
<li><p><strong>encryptor</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenericAlias</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">K</span></code>)]</span>) – A function that takes a key and message and outputs ctext</p></li>
<li><p><strong>decryptor</strong> – A function that takes a key and ciphertext and outputs plaintext</p></li>
<li><p><strong>decrytpor</strong> ()</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#toy_crypto.sec_games.StateError" title="toy_crypto.sec_games.StateError"><strong>StateError</strong></a> – if methods called in disallowed order.</p>
</dd>
</dl>
<dd><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">TransitionTable</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="p">{</span> <span class="o">&lt;</span><span class="n">State</span><span class="o">.</span><span class="n">STARTED</span><span class="p">:</span> <span class="s1">&#39;S&#39;</span><span class="o">&gt;</span><span class="p">:</span> <span class="p">{</span> <span class="o">&lt;</span><span class="n">Action</span><span class="o">.</span><span class="n">INITIALIZE</span><span class="p">:</span> <span class="s1">&#39;initialize&#39;</span><span class="o">&gt;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">State</span><span class="o">.</span><span class="n">INITIALIZED</span><span class="p">:</span> <span class="s1">&#39;I&#39;</span><span class="o">&gt;</span><span class="p">},</span>
                        <span class="o">&lt;</span><span class="n">State</span><span class="o">.</span><span class="n">INITIALIZED</span><span class="p">:</span> <span class="s1">&#39;I&#39;</span><span class="o">&gt;</span><span class="p">:</span> <span class="p">{</span> <span class="o">&lt;</span><span class="n">Action</span><span class="o">.</span><span class="n">ENCRYPT_ONE</span><span class="p">:</span> <span class="s1">&#39;encrypt_one&#39;</span><span class="o">&gt;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">State</span><span class="o">.</span><span class="n">CHALLENGED</span><span class="p">:</span> <span class="s1">&#39;C&#39;</span><span class="o">&gt;</span><span class="p">,</span>
                                                    <span class="o">&lt;</span><span class="n">Action</span><span class="o">.</span><span class="n">ENCRYPT</span><span class="p">:</span> <span class="s1">&#39;encrypt&#39;</span><span class="o">&gt;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">State</span><span class="o">.</span><span class="n">INITIALIZED</span><span class="p">:</span> <span class="s1">&#39;I&#39;</span><span class="o">&gt;</span><span class="p">,</span>
                                                    <span class="o">&lt;</span><span class="n">Action</span><span class="o">.</span><span class="n">DECRYPT</span><span class="p">:</span> <span class="s1">&#39;decrypt&#39;</span><span class="o">&gt;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">State</span><span class="o">.</span><span class="n">INITIALIZED</span><span class="p">:</span> <span class="s1">&#39;I&#39;</span><span class="o">&gt;</span><span class="p">},</span>
                        <span class="o">&lt;</span><span class="n">State</span><span class="o">.</span><span class="n">CHALLENGED</span><span class="p">:</span> <span class="s1">&#39;C&#39;</span><span class="o">&gt;</span><span class="p">:</span> <span class="p">{</span> <span class="o">&lt;</span><span class="n">Action</span><span class="o">.</span><span class="n">FINALIZE</span><span class="p">:</span> <span class="s1">&#39;finalize&#39;</span><span class="o">&gt;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">State</span><span class="o">.</span><span class="n">STARTED</span><span class="p">:</span> <span class="s1">&#39;S&#39;</span><span class="o">&gt;</span><span class="p">,</span>
                                                   <span class="o">&lt;</span><span class="n">Action</span><span class="o">.</span><span class="n">ENCRYPT</span><span class="p">:</span> <span class="s1">&#39;encrypt&#39;</span><span class="o">&gt;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">State</span><span class="o">.</span><span class="n">CHALLENGED</span><span class="p">:</span> <span class="s1">&#39;C&#39;</span><span class="o">&gt;</span><span class="p">}})</span>
</pre></div>
</div>
</dd><figure class="align-center" id="id5">
<img alt="State transition diagram generated from T_TABLE" src="../_images/IND-CCA1.png" />
<figcaption>
<p><span class="caption-text">IND-CCA1 game states and transitions</span><a class="headerlink" href="#id5" title="Link to this image">#</a></p>
</figcaption>
</figure>
<dl class="py attribute">
<dt class="sig sig-object py" id="toy_crypto.sec_games.IndCca1.TRACK_CHALLENGE_CTEXTS">
<span class="sig-name descname"><span class="pre">TRACK_CHALLENGE_CTEXTS</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#toy_crypto.sec_games.IndCca1.TRACK_CHALLENGE_CTEXTS" title="Link to this definition">#</a></dt>
<dd><p>This game does not need to record challenge ctexts.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="toy_crypto.sec_games.IndCca2">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">toy_crypto.sec_games.</span></span><span class="sig-name descname"><span class="pre">IndCca2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key_gen</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">KeyGenerator</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encryptor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Cryptor</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decrytpor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Cryptor</span><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/toy_crypto/sec_games.html#IndCca2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#toy_crypto.sec_games.IndCca2" title="Link to this definition">#</a></dt>
<dd><p>IND-CCA2 game.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key_gen</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenericAlias</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">K</span></code>)]</span>) – A key generation function appropriate for encryptor</p></li>
<li><p><strong>encryptor</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenericAlias</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">K</span></code>)]</span>) – A function that takes a key and message and outputs ctext</p></li>
<li><p><strong>decryptor</strong> – A function that takes a key and ciphertext and outputs plaintext</p></li>
<li><p><strong>decrytpor</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenericAlias</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">K</span></code>)]</span>)</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#toy_crypto.sec_games.StateError" title="toy_crypto.sec_games.StateError"><strong>StateError</strong></a> – if methods called in disallowed order.</p>
</dd>
</dl>
<dl class="py data">
<dt class="sig sig-object py" id="toy_crypto.sec_games.IndCca2.IndCca2.T_TABLE">
<span class="sig-name descname"><span class="pre">T_TABLE</span></span><a class="headerlink" href="#toy_crypto.sec_games.IndCca2.IndCca2.T_TABLE" title="Link to this definition">#</a></dt>
<dd><p>Transition Table to manage state of a game.</p>
<p>It can be treated like a mapping.</p>
</dd></dl>

<dd><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">TransitionTable</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="p">{</span> <span class="o">&lt;</span><span class="n">State</span><span class="o">.</span><span class="n">STARTED</span><span class="p">:</span> <span class="s1">&#39;S&#39;</span><span class="o">&gt;</span><span class="p">:</span> <span class="p">{</span> <span class="o">&lt;</span><span class="n">Action</span><span class="o">.</span><span class="n">INITIALIZE</span><span class="p">:</span> <span class="s1">&#39;initialize&#39;</span><span class="o">&gt;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">State</span><span class="o">.</span><span class="n">INITIALIZED</span><span class="p">:</span> <span class="s1">&#39;I&#39;</span><span class="o">&gt;</span><span class="p">},</span>
                        <span class="o">&lt;</span><span class="n">State</span><span class="o">.</span><span class="n">INITIALIZED</span><span class="p">:</span> <span class="s1">&#39;I&#39;</span><span class="o">&gt;</span><span class="p">:</span> <span class="p">{</span> <span class="o">&lt;</span><span class="n">Action</span><span class="o">.</span><span class="n">ENCRYPT_ONE</span><span class="p">:</span> <span class="s1">&#39;encrypt_one&#39;</span><span class="o">&gt;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">State</span><span class="o">.</span><span class="n">CHALLENGED</span><span class="p">:</span> <span class="s1">&#39;C&#39;</span><span class="o">&gt;</span><span class="p">,</span>
                                                    <span class="o">&lt;</span><span class="n">Action</span><span class="o">.</span><span class="n">ENCRYPT</span><span class="p">:</span> <span class="s1">&#39;encrypt&#39;</span><span class="o">&gt;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">State</span><span class="o">.</span><span class="n">INITIALIZED</span><span class="p">:</span> <span class="s1">&#39;I&#39;</span><span class="o">&gt;</span><span class="p">,</span>
                                                    <span class="o">&lt;</span><span class="n">Action</span><span class="o">.</span><span class="n">DECRYPT</span><span class="p">:</span> <span class="s1">&#39;decrypt&#39;</span><span class="o">&gt;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">State</span><span class="o">.</span><span class="n">INITIALIZED</span><span class="p">:</span> <span class="s1">&#39;I&#39;</span><span class="o">&gt;</span><span class="p">},</span>
                        <span class="o">&lt;</span><span class="n">State</span><span class="o">.</span><span class="n">CHALLENGED</span><span class="p">:</span> <span class="s1">&#39;C&#39;</span><span class="o">&gt;</span><span class="p">:</span> <span class="p">{</span> <span class="o">&lt;</span><span class="n">Action</span><span class="o">.</span><span class="n">FINALIZE</span><span class="p">:</span> <span class="s1">&#39;finalize&#39;</span><span class="o">&gt;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">State</span><span class="o">.</span><span class="n">STARTED</span><span class="p">:</span> <span class="s1">&#39;S&#39;</span><span class="o">&gt;</span><span class="p">,</span>
                                                   <span class="o">&lt;</span><span class="n">Action</span><span class="o">.</span><span class="n">ENCRYPT</span><span class="p">:</span> <span class="s1">&#39;encrypt&#39;</span><span class="o">&gt;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">State</span><span class="o">.</span><span class="n">CHALLENGED</span><span class="p">:</span> <span class="s1">&#39;C&#39;</span><span class="o">&gt;</span><span class="p">,</span>
                                                   <span class="o">&lt;</span><span class="n">Action</span><span class="o">.</span><span class="n">DECRYPT</span><span class="p">:</span> <span class="s1">&#39;decrypt&#39;</span><span class="o">&gt;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">State</span><span class="o">.</span><span class="n">CHALLENGED</span><span class="p">:</span> <span class="s1">&#39;C&#39;</span><span class="o">&gt;</span><span class="p">}})</span>
</pre></div>
</div>
</dd><figure class="align-center" id="id6">
<img alt="State transition diagram generated from T_TABLE" src="../_images/IND-CCA2.png" />
<figcaption>
<p><span class="caption-text">IND-CCA2 game states and transitions</span><a class="headerlink" href="#id6" title="Link to this image">#</a></p>
</figcaption>
</figure>
<dl class="py attribute">
<dt class="sig sig-object py" id="toy_crypto.sec_games.IndCca2.TRACK_CHALLENGE_CTEXTS">
<span class="sig-name descname"><span class="pre">TRACK_CHALLENGE_CTEXTS</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#toy_crypto.sec_games.IndCca2.TRACK_CHALLENGE_CTEXTS" title="Link to this definition">#</a></dt>
<dd><p>CCA2 needs to prevent decrypt() from decrypting challenge ctexts.</p>
</dd></dl>

</dd></dl>

</section>
<section id="state-management-tools">
<h2>State management tools<a class="headerlink" href="#state-management-tools" title="Link to this heading">#</a></h2>
<p>As described above, the difference between the particular gaves is defined
by what action the adversary can take when.
This is specified within the <a class="reference internal" href="#toy_crypto.sec_games.TransitionTable" title="toy_crypto.sec_games.TransitionTable"><code class="xref py py-class docutils literal notranslate"><span class="pre">TransitionTable</span></code></a> for each.</p>
<dl class="py class enum">
<dt class="sig sig-object py" id="toy_crypto.sec_games.State">
<em class="property"><span class="k"><span class="pre">enum</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">toy_crypto.sec_games.</span></span><span class="sig-name descname"><span class="pre">State</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/toy_crypto/sec_games.html#State"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#toy_crypto.sec_games.State" title="Link to this definition">#</a></dt>
<dd><p>The state a game.</p>
<dl class="field-list simple">
<dt class="field-odd">Member Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
<p>Valid values are as follows:</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="toy_crypto.sec_games.State.STARTED">
<span class="sig-name descname"><span class="pre">STARTED</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;State.STARTED:</span> <span class="pre">'S'&gt;</span></em><a class="headerlink" href="#toy_crypto.sec_games.State.STARTED" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="toy_crypto.sec_games.State.INITIALIZED">
<span class="sig-name descname"><span class="pre">INITIALIZED</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;State.INITIALIZED:</span> <span class="pre">'I'&gt;</span></em><a class="headerlink" href="#toy_crypto.sec_games.State.INITIALIZED" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="toy_crypto.sec_games.State.CHALLENGED">
<span class="sig-name descname"><span class="pre">CHALLENGED</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;State.CHALLENGED:</span> <span class="pre">'C'&gt;</span></em><a class="headerlink" href="#toy_crypto.sec_games.State.CHALLENGED" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class enum">
<dt class="sig sig-object py" id="toy_crypto.sec_games.Action">
<em class="property"><span class="k"><span class="pre">enum</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">toy_crypto.sec_games.</span></span><span class="sig-name descname"><span class="pre">Action</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/toy_crypto/sec_games.html#Action"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#toy_crypto.sec_games.Action" title="Link to this definition">#</a></dt>
<dd><p>Adversary actions (Methods called).</p>
<dl class="field-list simple">
<dt class="field-odd">Member Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
<p>Valid values are as follows:</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="toy_crypto.sec_games.Action.INITIALIZE">
<span class="sig-name descname"><span class="pre">INITIALIZE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Action.INITIALIZE:</span> <span class="pre">'initialize'&gt;</span></em><a class="headerlink" href="#toy_crypto.sec_games.Action.INITIALIZE" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="toy_crypto.sec_games.Action.ENCRYPT_ONE">
<span class="sig-name descname"><span class="pre">ENCRYPT_ONE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Action.ENCRYPT_ONE:</span> <span class="pre">'encrypt_one'&gt;</span></em><a class="headerlink" href="#toy_crypto.sec_games.Action.ENCRYPT_ONE" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="toy_crypto.sec_games.Action.ENCRYPT">
<span class="sig-name descname"><span class="pre">ENCRYPT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Action.ENCRYPT:</span> <span class="pre">'encrypt'&gt;</span></em><a class="headerlink" href="#toy_crypto.sec_games.Action.ENCRYPT" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="toy_crypto.sec_games.Action.DECRYPT">
<span class="sig-name descname"><span class="pre">DECRYPT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Action.DECRYPT:</span> <span class="pre">'decrypt'&gt;</span></em><a class="headerlink" href="#toy_crypto.sec_games.Action.DECRYPT" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="toy_crypto.sec_games.Action.FINALIZE">
<span class="sig-name descname"><span class="pre">FINALIZE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;Action.FINALIZE:</span> <span class="pre">'finalize'&gt;</span></em><a class="headerlink" href="#toy_crypto.sec_games.Action.FINALIZE" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="toy_crypto.sec_games.TransitionTable">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">toy_crypto.sec_games.</span></span><span class="sig-name descname"><span class="pre">TransitionTable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#toy_crypto.sec_games.State" title="toy_crypto.sec_games.State"><span class="pre">State</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#toy_crypto.sec_games.Action" title="toy_crypto.sec_games.Action"><span class="pre">Action</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#toy_crypto.sec_games.State" title="toy_crypto.sec_games.State"><span class="pre">State</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/toy_crypto/sec_games.html#TransitionTable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#toy_crypto.sec_games.TransitionTable" title="Link to this definition">#</a></dt>
<dd><p>Transition Table to manage state of a game.</p>
<p>It can be treated like a mapping.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>table</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code>[<a class="reference internal" href="#toy_crypto.sec_games.State" title="toy_crypto.sec_games.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code>[<a class="reference internal" href="#toy_crypto.sec_games.Action" title="toy_crypto.sec_games.Action"><code class="xref py py-class docutils literal notranslate"><span class="pre">Action</span></code></a>, <a class="reference internal" href="#toy_crypto.sec_games.State" title="toy_crypto.sec_games.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></a>]]</span>)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="toy_crypto.sec_games.TransitionTable.__getitem__">
<span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#toy_crypto.sec_games.State" title="toy_crypto.sec_games.State"><span class="pre">State</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#toy_crypto.sec_games.Action" title="toy_crypto.sec_games.Action"><span class="pre">Action</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#toy_crypto.sec_games.State" title="toy_crypto.sec_games.State"><span class="pre">State</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/toy_crypto/sec_games.html#TransitionTable.__getitem__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#toy_crypto.sec_games.TransitionTable.__getitem__" title="Link to this definition">#</a></dt>
<dd><p>So that items can be looked up with <code class="docutils literal notranslate"><span class="pre">[key]</span></code> as in a real dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>item</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#toy_crypto.sec_games.State" title="toy_crypto.sec_games.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></a></span>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code>[<a class="reference internal" href="#toy_crypto.sec_games.Action" title="toy_crypto.sec_games.Action"><code class="xref py py-class docutils literal notranslate"><span class="pre">Action</span></code></a>, <a class="reference internal" href="#toy_crypto.sec_games.State" title="toy_crypto.sec_games.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></a>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="toy_crypto.sec_games.TransitionTable.keys">
<span class="sig-name descname"><span class="pre">keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">KeysView</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#toy_crypto.sec_games.State" title="toy_crypto.sec_games.State"><span class="pre">State</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/toy_crypto/sec_games.html#TransitionTable.keys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#toy_crypto.sec_games.TransitionTable.keys" title="Link to this definition">#</a></dt>
<dd><p>Just like <code class="docutils literal notranslate"><span class="pre">keys</span></code> for a real dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">KeysView</span></code>[<a class="reference internal" href="#toy_crypto.sec_games.State" title="toy_crypto.sec_games.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></a>]</span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class protocol">
<dt class="sig sig-object py" id="toy_crypto.sec_games.SupportsTTable">
<em class="property"><span class="k"><span class="pre">protocol</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">toy_crypto.sec_games.</span></span><span class="sig-name descname"><span class="pre">SupportsTTable</span></span><a class="reference internal" href="../_modules/toy_crypto/sec_games.html#SupportsTTable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#toy_crypto.sec_games.SupportsTTable" title="Link to this definition">#</a></dt>
<dd><p>Has what it takes to be decorated by <a class="reference internal" href="#toy_crypto.sec_games.manage_state" title="toy_crypto.sec_games.manage_state"><code class="xref py py-func docutils literal notranslate"><span class="pre">manage_state()</span></code></a>.</p>
<p>This protocol also depends on a private member. See source if you need to
make this work for something other than an <a class="reference internal" href="#toy_crypto.sec_games.Ind" title="toy_crypto.sec_games.Ind"><code class="xref py py-class docutils literal notranslate"><span class="pre">Ind</span></code></a>.
Classes that implement this protocol must have the following methods / attributes:</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="toy_crypto.sec_games.SupportsTTable.current_state">
<span class="sig-name descname"><span class="pre">current_state</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#toy_crypto.sec_games.State" title="toy_crypto.sec_games.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></a></em><a class="headerlink" href="#toy_crypto.sec_games.SupportsTTable.current_state" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="toy_crypto.sec_games.SupportsTTable.t_table">
<span class="sig-name descname"><span class="pre">t_table</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#toy_crypto.sec_games.TransitionTable" title="toy_crypto.sec_games.TransitionTable"><code class="xref py py-class docutils literal notranslate"><span class="pre">TransitionTable</span></code></a></em><a class="headerlink" href="#toy_crypto.sec_games.SupportsTTable.t_table" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<p>Each method that the adversary can call is wrapped by the <a class="reference internal" href="#toy_crypto.sec_games.manage_state" title="toy_crypto.sec_games.manage_state"><code class="xref py py-deco docutils literal notranslate"><span class="pre">&#64;manage_state</span></code></a> decorator</p>
<dl class="py function">
<dt class="sig sig-object py" id="toy_crypto.sec_games.manage_state">
<span class="sig-prename descclassname"><span class="pre">&#64;</span></span><span class="sig-prename descclassname"><span class="pre">toy_crypto.sec_games.</span></span><span class="sig-name descname"><span class="pre">manage_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">F</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">F</span></span></span><a class="reference internal" href="../_modules/toy_crypto/sec_games.html#manage_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#toy_crypto.sec_games.manage_state" title="Link to this definition">#</a></dt>
<dd><p>Decorator to check/transition state for Ind method calls.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fn</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">F</span></code>, bound= <code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>])</span>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">F</span></code>, bound= <code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>])</span></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Footnotes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="reinit" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id1">1</a>,<a role="doc-backlink" href="#id2">2</a>)</span>
<p>The reason I separated game initialization from game creation is
because the user may wish to rerun a game many times.
After all, the adversary doesn’t need to win every time to win overall.
It only needs to win meaningfully more than half the time.
And so I didn’t want to user to have to create a large number of
instances of a game class and have to
rely on the Python garbage collector to free up memory.</p>
</aside>
</aside>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="ec.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Elliptic curves</p>
      </div>
    </a>
    <a class="right-next"
       href="vigenere.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Vigenère cipher</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#general-structure">General Structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exceptions">Exceptions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.StateError"><code class="docutils literal notranslate"><span class="pre">StateError</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#types-for-encryption-scheme">Types for encryption scheme</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.K"><code class="docutils literal notranslate"><span class="pre">K</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.KeyGenerator"><code class="docutils literal notranslate"><span class="pre">KeyGenerator</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.Cryptor"><code class="docutils literal notranslate"><span class="pre">Cryptor</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-class-and-method-organization">The class and method organization</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.Ind"><code class="docutils literal notranslate"><span class="pre">Ind</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.Ind.TRACK_CHALLENGE_CTEXTS"><code class="docutils literal notranslate"><span class="pre">Ind.TRACK_CHALLENGE_CTEXTS</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.Ind.initialize"><code class="docutils literal notranslate"><span class="pre">Ind.initialize()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.Ind.encrypt_one"><code class="docutils literal notranslate"><span class="pre">Ind.encrypt_one()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.Ind.finalize"><code class="docutils literal notranslate"><span class="pre">Ind.finalize()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.Ind.encrypt"><code class="docutils literal notranslate"><span class="pre">Ind.encrypt()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.Ind.decrypt"><code class="docutils literal notranslate"><span class="pre">Ind.decrypt()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.IndEav"><code class="docutils literal notranslate"><span class="pre">IndEav</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.IndEav.IndEav.T_TABLE"><code class="docutils literal notranslate"><span class="pre">IndEav.T_TABLE</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.IndEav.TRACK_CHALLENGE_CTEXTS"><code class="docutils literal notranslate"><span class="pre">IndEav.TRACK_CHALLENGE_CTEXTS</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.IndCpa"><code class="docutils literal notranslate"><span class="pre">IndCpa</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.IndCpa.IndCpa.T_TABLE"><code class="docutils literal notranslate"><span class="pre">IndCpa.T_TABLE</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.IndCpa.TRACK_CHALLENGE_CTEXTS"><code class="docutils literal notranslate"><span class="pre">IndCpa.TRACK_CHALLENGE_CTEXTS</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.IndCca1"><code class="docutils literal notranslate"><span class="pre">IndCca1</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.IndCca1.TRACK_CHALLENGE_CTEXTS"><code class="docutils literal notranslate"><span class="pre">IndCca1.TRACK_CHALLENGE_CTEXTS</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.IndCca2"><code class="docutils literal notranslate"><span class="pre">IndCca2</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.IndCca2.IndCca2.T_TABLE"><code class="docutils literal notranslate"><span class="pre">IndCca2.T_TABLE</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.IndCca2.TRACK_CHALLENGE_CTEXTS"><code class="docutils literal notranslate"><span class="pre">IndCca2.TRACK_CHALLENGE_CTEXTS</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#state-management-tools">State management tools</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.State"><code class="docutils literal notranslate"><span class="pre">State</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.State.STARTED"><code class="docutils literal notranslate"><span class="pre">State.STARTED</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.State.INITIALIZED"><code class="docutils literal notranslate"><span class="pre">State.INITIALIZED</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.State.CHALLENGED"><code class="docutils literal notranslate"><span class="pre">State.CHALLENGED</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.Action"><code class="docutils literal notranslate"><span class="pre">Action</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.Action.INITIALIZE"><code class="docutils literal notranslate"><span class="pre">Action.INITIALIZE</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.Action.ENCRYPT_ONE"><code class="docutils literal notranslate"><span class="pre">Action.ENCRYPT_ONE</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.Action.ENCRYPT"><code class="docutils literal notranslate"><span class="pre">Action.ENCRYPT</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.Action.DECRYPT"><code class="docutils literal notranslate"><span class="pre">Action.DECRYPT</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.Action.FINALIZE"><code class="docutils literal notranslate"><span class="pre">Action.FINALIZE</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.TransitionTable"><code class="docutils literal notranslate"><span class="pre">TransitionTable</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.TransitionTable.__getitem__"><code class="docutils literal notranslate"><span class="pre">TransitionTable.__getitem__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.TransitionTable.keys"><code class="docutils literal notranslate"><span class="pre">TransitionTable.keys()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.SupportsTTable"><code class="docutils literal notranslate"><span class="pre">SupportsTTable</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.SupportsTTable.current_state"><code class="docutils literal notranslate"><span class="pre">SupportsTTable.current_state</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.SupportsTTable.t_table"><code class="docutils literal notranslate"><span class="pre">SupportsTTable.t_table</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#toy_crypto.sec_games.manage_state"><code class="docutils literal notranslate"><span class="pre">manage_state()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/modules/games.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024–2025 Jeffrey Goldberg.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>